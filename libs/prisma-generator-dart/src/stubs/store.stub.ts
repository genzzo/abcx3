
export const dartStoreStub = `
#{AutoGeneratedWarningText}

part of abcx3_stores;


class #{Model}Store extends ModelStreamStore<int, #{Model}> {

  static #{Model}Store? _instance;

  static #{Model}Store get instance {
    _instance ??= #{Model}Store();
    return _instance!;
  }

  #{Model}Store() : super(#{Model}.fromJson);

  /// GET PROPERTIES FROM MODEL

  #{GetValMethods}

  /// GET THIS MODEL

  #{GetAll$}

  #{GetByPropertyVal$}

  #{GetManyByPropertyVal$}

  /// GET RELATED MODELS WITH ID STORED IN THIS MODEL

  #{GetRelatedModelsWithId$}

  /// GET RELATED MODELS 

  #{GetRelatedModels$}


}

#{ClassInclude}


enum #{Model}Endpoints implements Endpoint {

    #{Endpoints};

    const #{Model}Endpoints(this.path, this.method, this.responseType);

    @override
  final String path;

  @override
  final HttpMethod method;

  final Type responseType;

  static String withPathParameter(String path, dynamic param) {
    final regex = RegExp(r':([a-zA-Z]+)');
    return path.replaceFirst(regex, param.toString());
  }
}
`;

export const dartStoreClassIncludeStub = `
class #{Model}Include implements StoreIncludes {

    @override
    bool useCache;
  
    @override
    late Function method;
  
      #{IncludeConstructors}
  }`;

export const dartStoreIncludesConstructor = `#{Model}Include.#{fieldName}({this.useCache = true, #{IncludeType} include}) {
    method = (#{moDel}) => #{Model}Store.instance.get#{FieldName}$(#{moDel}, useCache: useCache, include: include);
}`;

export const dartStoreIncludesEmptyConstructor = `#{Model}Include.empty({this.useCache = true});`;

export const dartStoreGetVal = `#{FieldType}#{Nullable} get#{Model}#{FieldName}(#{Model} #{moDel}) => #{moDel}.#{fieldName};`;


export const dartStoreGetAll$ = `Stream<List<#{Model}>> getAll$({bool useCache = true, List<#{Model}Include>? include}) {
    final allItems$ = getAllItems$(endpoint: #{Model}Endpoints.#{EndPointAllName}, useCache: useCache);
    if (include == null || include.isEmpty) {
        return allItems$;
      } else {
        return getManyIncluding$(allItems$, include);
      }
    }
`;


export const dartStoreGetByPropertyVal$ = `Stream<#{Model}?> getBy#{FieldName}$(#{FieldType} #{fieldName}, {bool useCache = true, List<#{Model}Include>? include}) {
    final item$ = getByFieldValue$<#{FieldType}>(getPropVal: get#{Model}#{FieldName}, value: #{fieldName}, endpoint: #{Model}Endpoints.#{EndPointName}, useCache: useCache);
    if (include == null || include.isEmpty) {
        return item$;
    } else {
        return getIncluding$<#{Model}?>(item$, include);
    }
}
`;

export const dartStoreGetManyByPropertyVal$ = `Stream<List<#{Model}>> getBy#{FieldName}$(#{FieldType} #{fieldName}, {bool useCache = true, List<#{Model}Include>? include}) {
    final items$ = getManyByFieldValue$<#{FieldType}>(getPropVal: get#{Model}#{FieldName}, value: #{fieldName}, endpoint: #{Model}Endpoints.#{EndPointManyName}, useCache: useCache);
    if (include == null || include.isEmpty) {
        return items$;
    } else {
        return getManyIncluding$<#{Model}>(items$, include);
    }
}
`;

/* export const dartStoreGetRelatedModelsWithId$ = `Stream<#{StreamReturnType}> get#{FieldName}$(#{Model} #{moDel}, {bool useCache = true, #{IncludeType} include}) {
    if (#{moDel}.#{fieldName} != null && useCache) {
        return Stream.value(#{moDel}.#{fieldName}!);
      } else {
        final item$ = #{FieldType}Store.instance.getById$(#{moDel}.#{relationFromField}!)
            .doOnData((#{fieldName}) {
                #{moDel}.#{fieldName} = #{fieldName};
        });
        if (include == null || include.isEmpty) {
            return item$;
        } else {
            return #{getIncluding$}<#{GetIncludingType}>(item$, include);
        }
      }
}`; */
export const dartStoreGetRelatedModelsWithId$ = `Stream<#{StreamReturnType}> get#{FieldName}$(#{Model} #{moDel}, {bool useCache = true, #{IncludeType} include}) {
    Stream<#{StreamReturnType}> #{fieldName}$;
    if (#{moDel}.#{fieldName} != null && useCache) {
        #{fieldName}$ = Stream.value(#{moDel}.#{fieldName}!);
    } else {
        #{fieldName}$ = #{FieldType}Store.instance.getById$(#{moDel}.#{relationFromField}!, useCache: useCache)
            .doOnData((#{fieldName}) {
                #{moDel}.#{fieldName} = #{fieldName};
        });
    }
    if (include == null || include.isEmpty) {
        return #{fieldName}$;
    } else {
        return #{getIncluding$}<#{GetIncludingType}>(#{fieldName}$, include);
    }
}`;

export const dartStoreGetRelatedModels$ = `Stream<#{StreamReturnType}> get#{FieldName}$(#{Model} #{moDel}, {bool useCache = true, #{IncludeType} include}) {
    Stream<#{StreamReturnType}> #{fieldName}$;
    if (#{moDel}.#{fieldName} != null && useCache) {
        #{fieldName}$ = Stream.value(#{moDel}.#{fieldName}!);
    } else {
        #{fieldName}$ = #{RelatedModelStore}.instance.getBy#{RelationToFieldName}$(#{moDel}.$uid!, useCache: useCache)
            .doOnData((#{fieldName}) {
                #{moDel}.#{fieldName} = #{fieldName};
        });
    }
    if (include == null || include.isEmpty) {
        return #{fieldName}$;
    } else {
        return #{getIncluding$}<#{GetIncludingType}>(#{fieldName}$, include);
    }
}`;
/* export const dartStoreGetRelatedModels$ = `Stream<#{StreamReturnType}> get#{FieldName}$(#{Model} #{moDel}, {bool useCache = true, #{IncludeType} include}) {
    if (#{moDel}.#{fieldName} != null && useCache) {
        return Stream.value(#{moDel}.#{fieldName}!);
      } else {
        final items$ = #{RelatedModelStore}.instance.getBy#{RelationToFieldName}$(#{moDel}.$uid!)
            .doOnData((#{fieldName}) {
                #{moDel}.#{fieldName} = #{fieldName};
        });
        if (include == null || include.isEmpty) {
            return items$;
        } else {
            return #{getIncluding$}<#{GetIncludingType}>(items$, include);
        }
      }
}`; */


export const dartStoreEndpointName = `getBy#{FieldName}`;

export const dartStoreEndpointManyName = `getManyBy#{FieldName}`;

export const dartStoreEndpointAllName = `getAll`;

export const dartStoreEndpoint = `#{EndPointName}('/#{moDel}/by#{FieldName}/:#{fieldName}', HttpMethod.get, #{Model})`;

export const dartStoreEndpointMany = `#{EndPointManyName}('/#{moDel}/by#{FieldName}/:#{fieldName}', HttpMethod.get, List<#{Model}>)`;

export const dartStoreEndpointAll = `#{EndPointAllName}('/#{moDel}', HttpMethod.get, List<#{Model}>)`;



